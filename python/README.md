# Pangolin Python Scripts

## holders
This directory contains scripts to get a daily average of token transfers, mint/burn of lp token/token2 and staking token

### Create Python Environment
`python -m venv env`

### Active Environment 

#### On Linux
Run the command bellow:

`source <path to env>/env/bin/activate`

#### On Windows
Run the command bellow:

`<path to env>\env\Scripts\activate.bat`

### Install libs

`pip3 install -r requirements.txt`

# get_holders.py

This script get all transfers for PNG token, PNG transfers in Mint/Burn LP PNG/AVAX and PNG transfers in Staking to Earn AVAX/OOE/APEIN, **this script need to install** [MongoDB](https://www.mongodb.com/) or some service for MongoDB in cloud for example [MongoDB Atlas](https://www.mongodb.com/atlas/database).

## Config
Go to [config.ini](config.ini) and edit items of section called [GetHolders].

![Image 1](https://i.imgur.com/6v2PpdB.png)

**If you use MongoDB in cloud, add the connection string in [config.ini](config.ini) in [Mongodb] section**.

![Image 2](https://i.imgur.com/5h256rA.png)

## Run
`python get_holders.py`

# export_holders.py

This script export PNG transfers from Tokens, LP and Staking to csv. Data is generated by get_holders.py and withdrawn from MongoDB.

**Run get_holders.py first**

![Image 3](https://i.imgur.com/9OdOAaI.png)

## Run
`python export_holders.py`

# block_by_date.py
This script get block by date

![Image 3](https://i.imgur.com/dR992GT.png)

## Run 
`python block_by_date.py`

# get_png_pools.py
This script get all pools with PNG as pair and save in [pools.json](src/constants/pools.json)

## Run 
`python get_png_pools.py`

# swap_fee.py
This script generates swap fee chart and exports to a CSV

## Run 
`python swap_fee.py`

## View
You can see in the browser, the URL will be available on the console

In this case it is http://127.0.0.1:8050/

![Image 4](https://i.imgur.com/InLxbLj.png)

![Image 5](https://i.imgur.com/ERuKrrC.png)


## Use with docker & docker compose 

### Docker & pycharm
The dockerfile can be used with pycharm to build interpreter https://www.jetbrains.com/help/pycharm/using-docker-as-a-remote-interpreter.html#example to ensure portability across environments while developing.

### Run scripts w/ docker compose 
It is also possible to launch environment locally with a simple docker compose command. It allows also to run the scripts on development servers or on services running docker containers. 


To test locally: 

copy the example env vars 
```
cp .env.example .env
```
launch containers
```
docker compose up -d 
```

will build a python + required dbs environment for testing 

Now the container shell is accessible through docker: 
```
 docker exec -it pangopython /bin/bash
```

and it is possible to run the different scripts available, once connected to the shell: 
```
python get_holders.py
```

## local mongodb

Mongodb database is accessible with any mongodb interface like compass https://www.mongodb.com/try/download/compass
The default set up is the following connection string: mongodb://admin:password@localhost:27017/?authSource=admin

## others
This directory contains small scripts with various functions, see the [README](others/README.md) inside
